# 📖 詳細な使い方ガイド

## 目次
1. [初めての方向け：クイックスタート](#初めての方向けクイックスタート)
2. [各ノートブックの詳細](#各ノートブックの詳細)
3. [モデルの選び方](#モデルの選び方)
4. [トラブルシューティング](#トラブルシューティング)

## 初めての方向け：クイックスタート

### ステップ1: Google Colabの準備

1. Googleアカウントでログイン
2. [Google Colab](https://colab.research.google.com/)にアクセス
3. 「ファイル」→「ノートブックをアップロード」から、ダウンロードした`.ipynb`ファイルを選択

### ステップ2: GPUの設定

```
ランタイム → ランタイムのタイプを変更 → ハードウェアアクセラレータ → GPU (T4)
```

### ステップ3: セルの実行

1. セルを上から順番に実行（Shift + Enter）
2. ライブラリのインストールが自動で行われます
3. YouTube URLを入力するセルで動画URLを指定
4. 文字起こし実行セルを実行

### ステップ4: 結果の確認

- 実行が完了すると、左側のファイルパネルに結果のテキストファイルが表示されます
- ファイルをダウンロードして確認できます

## 各ノートブックの詳細

### ⭐ 推奨ノートブック（最新版）

#### 📹 【完成版】動画URLから高精度文字起こし実行スクリプト.ipynb

**推奨用途**: YouTube動画やプレイリストから文字起こしをしたい方（初心者〜中級者）

**コンセプト**: **YouTube URL入力だけで完結する全自動文字起こし**

**主な特徴**:
- 🎬 **YouTube専用設計**: URLを入力するだけで、ダウンロード→音声抽出→文字起こしを全自動実行
- 📂 **プレイリスト一括処理**: プレイリストURLで全動画を自動処理（有効/無効切替可能）
- 🚀 **yt-dlp完全統合**: 最新のyt-dlpで安定した動画ダウンロード
- 🎯 **VAD（音声区間検出）**: 無音区間を自動除去して精度向上
- 🧹 **自動クリーンアップ**: 処理完了後に一時ファイルを自動削除
- ⚙️ **詳細設定**: beam_size、VADパラメータ、モデル選択などをGUI的に調整可能

**実行ステップ**:
```python
# セル1: 環境構築（yt-dlp, faster-whisper, ffmpegをインストール）
# セル2: Google Driveへの接続（任意）
# セル3: 設定して実行

# --- セル3の設定例 ---
# YouTube動画URL
video_url = "https://www.youtube.com/watch?v=VIDEO_ID"

# プレイリストの場合
video_url = "https://www.youtube.com/playlist?list=PLAYLIST_ID"
enable_playlist = True  # プレイリスト内の全動画を処理

# モデル選択
model_name = "Zoont/faster-whisper-large-v3-turbo-int8-ct2"  # 推奨
compute_type = "int8_float16"  # 推奨

# VAD設定
use_vad_filter = True  # 無音除去を有効化
vad_min_silence_duration_ms = 300  # 無音判定の閾値

# 実行すると自動で処理が開始されます
```

**出力**: Google Driveまたは/contentフォルダにテキストファイルが保存されます

---

#### ⚙️ 【完成版】高性能文字起こし実行セル_(モデル・量子化_選択肢追加版).ipynb

**推奨用途**: Google Drive内の動画・音声ファイルを大量処理したい方（中級者〜上級者）

**コンセプト**: **Google Driveのローカルファイル一括バッチ処理専用**

**主な特徴**:
- 📁 **フォルダ一括処理**: 指定フォルダ内の全ファイルを自動で順次処理
- 🎬 **動画ファイル自動対応**: mp4, mov, avi, mkv, webmなどから自動で音声抽出
- 🎵 **音声ファイル直接対応**: wav, mp3などをそのまま処理
- 🔧 **FFmpeg自動最適化**: 動画を16kHz/モノラルに変換して精度向上
- 🎛️ **9種類のモデル選択**: Zoont/deepdml最適化モデル + 標準モデル全種類
- ⚡ **4種類の量子化**: int8_float16, float16, int8, float32から選択
- 📊 **詳細ログ出力**: 処理時間、使用モデル、計算タイプを記録
- 💪 **細かい調整**: beam_size、VAD設定、各種パラメータを詳細にカスタマイズ可能

**実行ステップ**:
```python
# セル1: 環境構築（faster-whisperとCUDAライブラリをインストール）
# セル2: Google Driveへの接続（必須）
# セル3: 設定して実行

# --- セル3の設定例 ---
# Google Driveのパス設定
drive_audio_input_dir = "/content/drive/MyDrive/Colab/Whisper_Transcripts/input_audio"
drive_transcript_output_dir = "/content/drive/MyDrive/Colab/Whisper_Transcripts/output_transcripts"

# モデルとパフォーマンス設定
model_name = "Zoont/faster-whisper-large-v3-turbo-int8-ct2"  # 9種類から選択
compute_type = "int8_float16"  # 4種類から選択

# VAD設定
use_vad_filter = True
vad_min_silence_duration_ms = 300

# 高度な設定
beam_size = 5  # 1-10の範囲で調整可能

# 実行前に input_audio フォルダに動画・音声ファイルを配置してください
# 実行すると、フォルダ内の全ファイルを順次処理します
```

**出力**: output_transcriptsフォルダに元ファイル名対応のテキストファイルが保存されます

---

### 📦 その他のノートブック（旧版・参考用）

以下は旧バージョンまたは特定機能に特化したノートブックです。基本的には上記2つの推奨版をご利用ください。

#### 📄 動画URLから高精度文字起こし実行スクリプト.ipynb

- 完成版の旧バージョン
- 基本的な機能は同じですが、最新の最適化が含まれていません

#### 🔤 文字起こしコード.ipynb

- 基本的な文字起こし機能のみ
- 学習・カスタマイズ用の参考コード

#### 🎯 高性能・多機能_文字起こし実行セル.ipynb

- 多機能版の旧バージョン
- 一部機能が古い実装になっています

#### ⚡ 高性能文字起こし実行セル_(large_v3_turbo対応版).ipynb

- large-v3-turboモデル特化版
- 現在は完成版でも対応済みのため、そちらを推奨

#### 📁 高性能文字起こし実行セル_(動画ファイル自動対応版).ipynb

- 動画ファイル自動検出版
- 現在は完成版でも対応済みのため、そちらを推奨

## モデルの選び方

### 対応モデル一覧

| モデル | メモリ使用量 | 処理速度 | 精度 | 推奨用途 |
|--------|------------|---------|------|---------|
| **Zoont/faster-whisper-large-v3-turbo-int8-ct2** | 中 | 非常に速い | 最高 | **最推奨・バランス型** |
| **deepdml/faster-whisper-large-v3-turbo-ct2** | 大 | 速い | 最高 | 高精度・高速処理 |
| **large-v3** | 最大 | 遅い | 最高 | 最高精度が必要な場合 |
| **large-v2** | 最大 | 遅い | 最高 | v3使用不可時の代替 |
| **distil-large-v3** | 中 | 速い | 高 | 速度と精度のバランス |
| **medium** | 中 | 普通 | 高 | 一般的な用途 |
| **small** | 小 | 速い | 中 | 簡単な会話・大量処理 |
| **base** | 小 | 速い | 中 | テスト・短い音声 |
| **tiny** | 最小 | 最速 | 低 | 動作確認用 |

### 量子化オプション

| 量子化タイプ | メモリ使用量 | 処理速度 | 精度 | 推奨度 |
|------------|------------|---------|------|--------|
| **int8_float16** | 低 | 速い | 高 | ⭐⭐⭐ 最推奨 |
| **float16** | 中 | 標準 | 最高 | ⭐⭐ 標準 |
| **int8** | 最低 | 速い | 中 | ⭐ 省メモリ重視 |
| **float32** | 高 | 遅い | 最高 | 精度最優先時のみ |

### 推奨設定

**🎯 初心者・汎用用途（推奨）**:
```python
model_name = "Zoont/faster-whisper-large-v3-turbo-int8-ct2"
compute_type = "int8_float16"
```
- 最もバランスが良く、Google Colab無料版で快適に動作
- 精度と速度を両立

**⚡ 速度重視・大量処理**:
```python
model_name = "distil-large-v3"
compute_type = "int8_float16"
```
- プレイリスト一括処理などに最適

**🏆 最高精度重視**:
```python
model_name = "deepdml/faster-whisper-large-v3-turbo-ct2"
compute_type = "float16"
```
- 重要な会議や講演の文字起こしに

**💻 メモリ節約（Google Colab制限回避）**:
```python
model_name = "medium"
compute_type = "int8"
```
- メモリ不足エラーが出た場合の代替案

## トラブルシューティング

### ❌ メモリ不足エラー

**症状**: 
```
RuntimeError: CUDA out of memory
```

**解決策**:
1. 小さいモデルを使用（large → medium → small）
2. 量子化を有効化（int8推奨）
3. ランタイムを再起動: ランタイム → ランタイムを再起動

### ❌ GPU が利用できない

**症状**:
```
GPU not available
```

**解決策**:
1. ランタイム → ランタイムのタイプを変更 → GPU (T4)を選択
2. Google Colab無料版の利用制限に達している可能性
3. しばらく時間をおいて再試行

### ❌ YouTube動画がダウンロードできない

**症状**:
```
ERROR: Video unavailable
```

**解決策**:
1. URLが正しいか確認
2. 動画が非公開・削除されていないか確認
3. 年齢制限がかかっている動画は処理できない場合があります

### ❌ 文字起こし結果が不正確

**解決策**:
1. より大きいモデルを使用（medium → large → large-v3）
2. 音質の良い音源を使用
3. 言語設定を明示的に指定（日本語の場合: `language="ja"`）

### ❌ 処理が途中で止まる

**症状**:
セルの実行が終わらない

**解決策**:
1. ランタイム → セルの実行を中断
2. ランタイムを再起動
3. より小さいモデルを試す
4. 動画を分割して処理

## よくある質問（FAQ）

### Q1: 無料で使えますか？
A: はい、Google Colabの無料版で利用できます。ただし、連続使用時間（最大12時間）や月間使用量に制限があります。

### Q2: どのくらいの長さの動画まで処理できますか？
A: モデルサイズによりますが、数時間の動画も処理可能です。ただし、無料版では実行時間制限（最大12時間）があります。長時間動画は分割処理を推奨します。

### Q3: 日本語以外の言語にも対応していますか？
A: はい、Whisperは100以上の言語に対応しています。自動言語検出も可能です。

### Q4: プライベートな動画も処理できますか？
A: はい。
- **YouTube URL版**: 非公開動画は処理できません
- **Google Drive版**: ローカルファイルを使用するため、プライベートな動画も処理可能です

### Q5: 商用利用は可能ですか？
A: MITライセンスのため、商用利用も可能です。ただし、YouTube動画を使用する場合はYouTubeの利用規約を遵守してください。

### Q6: 2つの推奨ノートブックの違いは？
A: 
- **【完成版】動画URL版**: YouTube URLを入力するだけで自動処理。初心者向け。
- **【完成版】モデル・量子化版**: Google Drive内のファイルを一括処理。大量処理・カスタマイズ重視。

### Q7: プレイリストは何本まで処理できますか？
A: 技術的な制限はありませんが、Google Colabの実行時間制限（12時間）があります。動画数と長さに応じて計算してください。

### Q8: 字幕ファイル（SRT形式など）は出力できますか？
A: 現在はプレーンテキスト(.txt)のみ出力します。タイムスタンプ付き字幕形式は今後の機能追加を検討中です。

## 💡 Tips

### より良い結果を得るために

1. **音質の良い音源を使う**: ノイズの少ない音源ほど精度が向上
2. **適切なモデルを選ぶ**: 用途に応じてモデルを使い分ける
   - 日常用途: `Zoont/faster-whisper-large-v3-turbo-int8-ct2` + `int8_float16`
   - 高精度必須: `deepdml/faster-whisper-large-v3-turbo-ct2` + `float16`
3. **VADフィルタを活用**: 無音区間を除去して精度向上
4. **長い動画は分割**: 30分〜1時間ごとに分割すると処理が安定
5. **Google Drive版で大量処理**: 複数ファイルを処理する場合はGoogle Drive版が効率的

### 使い分けのコツ

**YouTube URL版を使うべき場合**:
- YouTube動画やプレイリストを処理したい
- URLだけで手軽に文字起こししたい
- ダウンロード作業を省略したい
- 初めて使う、シンプルな操作を好む

**Google Drive版を使うべき場合**:
- 既にダウンロード済みのファイルがある
- 複数の動画・音声ファイルを一括処理したい
- プライベートなファイルを処理したい
- モデルや設定を細かくカスタマイズしたい
- mp4, movなど様々な動画形式を処理したい

### エラーを防ぐために

1. **GPU設定を確認**: 必ずGPU (T4)を選択してから実行
2. **メモリ管理**: 大きいモデルを使う前にランタイムを再起動
3. **段階的に試す**: 最初は小さいモデルでテスト、問題なければ大きいモデルへ
4. **URLの確認**: YouTube URLは動画ページからコピー（共有リンクではなく）
5. **ファイル名に注意**: Google Drive版では日本語ファイル名も対応していますが、英数字推奨

### 処理時間の目安

Google Colab T4 GPU使用時の目安（10分の音声の場合）:

| モデル | 処理時間 | 実時間比 |
|--------|---------|---------|
| **Zoont/...-int8-ct2** | 約2-3分 | 0.2-0.3倍 | ⭐推奨 |
| **deepdml/...-ct2** | 約3-4分 | 0.3-0.4倍 |
| **distil-large-v3** | 約3-4分 | 0.3-0.4倍 |
| **medium** | 約5分 | 0.5倍 |
| **small** | 約3分 | 0.3倍 |
| **large-v3** | 約8-10分 | 0.8-1.0倍 |

**注意**: 
- VADフィルタ有効時は処理時間が若干増加します
- 動画のダウンロード時間は別途必要です（yt-dlp使用時）
- プレイリスト処理では動画数×上記時間が必要です

## 📚 参考リンク

- [OpenAI Whisper 公式](https://github.com/openai/whisper)
- [Google Colab](https://colab.research.google.com/)
- [faster-whisper](https://github.com/guillaumekln/faster-whisper)

---

質問や問題がある場合は、[Issues](https://github.com/Taichi2005/GoogleColab_Whisper/issues)でお知らせください！
